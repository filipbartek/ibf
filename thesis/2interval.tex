\chapter{\texorpdfstring{$2$}{2}-interval functions}

In this chapter we will revise the results specific to
$2$-interval functions.
\dubovsky{}'s
thesis \cite{Dubovsky2012}
provides more detailed information.

\dubovsky{} identified several classes
of $2$-interval functions \cite[p.~5]{Dubovsky2012}
which seem to require different approaches for spanning.
% TODO: Reword "seem to require".
I find \husek{}'s concept of
\quot{step} \cite[p.~13]{Husek2014}
(\quot{\foreignlanguage{czech}{zlom}} in Czech)
useful to differentiate between these classes.

\begin{definition}[$l$-step function]
A Boolean function $f$ is \definiendum{$l$-step}
if and only if
there are exactly $l$ input vectors $x$ such that
$f(x) \neq f(x+1)$.
\end{definition}

It is easy to see that
prefix and suffix interval functions are $1$-step.

Depending on $f(0)$,
an $l$-step Boolean function $f$
is $\ceil*{\frac{l}{2}}$-interval in case $f(0) = 0$,
% f(0) = 0:
% 1-step: 1-interval
% 2-step: 1-interval
% 3-step: 2-interval
% 4-step: 2-interval
% l-step: \ceil{l/2}-interval
or $\ceil*{\frac{l+1}{2}}$-interval in case $f(0) = 1$.
% f(0) = 1:
% 1-step: 1-interval
% 2-step: 2-interval
% 3-step: 2-interval
% 4-step: 3-interval
% l-step: \ceil{(l+1)/2}-interval

Namely,
a $2$-step Boolean function such that $f(0) = 0$
is $1$-interval.

\section{\texorpdfstring{$2$}{2}-step functions}

Let $f$ be a $2$-interval $2$-step Boolean function
(necessarily $f(\rep{0}{n}) = f(\rep{1}{n})
= 1$).\footnote{This corresponds to class $A_0$
in \dubovsky{}'s classification
\cite[p.~5]{Dubovsky2012}.}
We will show that $f$
can be optimally spanned by reduction to
a $2$-step $1$-interval Boolean function $f'$
of at most the same arity,
which can be spanned using the algorithm introduced
in chapter \ref{chap:1interval}.

Note that
\dubovsky{} introduced an optimization algorithm for
this class of functions \cite[section 3.2]{Dubovsky2012},
following an argument similar to the one used by
Schieber et al. to span $1$-interval functions
\cite{Schieber2005154}.
However,
the reduction approach gives
an interesting insight in the problem
and seems easier to describe.
% TODO: Consider rewording.

From the definition of $f$ we know that it is $2$-interval
with the outer interval endpoints being
$\rep{0}{n}$ and $\rep{1}{n}$:

\[
f = f^n_{\interval{\rep{0}{n}}{b_1},
\interval{a_2}{\rep{1}{n}}}
\]

Let's call the inner interval endpoints $b_1$ and $a_2$.
$\rep{0}{n} \leq b_1$,
$b_1 \leq a_2 - 2$,
$a_2 \leq \rep{1}{n}$.

\subsection{\texorpdfstring{$\bit{b_1}{1} = \bit{a_2}{1}$}
{b1[1] = a2[1]}
}

In case $b_1$ and $a_2$ have the same \acrshort{msb}s,
we recursively solve the $(n-1)$-bit
case
$\interval{\rep{0}{n-1}}{\bits{b_1}{2}{n}},
\interval{\bits{a_2}{2}{n}}{\rep{1}{n-1}}$,
and add an extra ternary vector to span the remainder
of the true points.

Without loss of generality,
let $\bit{b_1}{1} = \bit{a_2}{1} = 0$.
The complementary case is symmetric.

Let $b_1' = \bits{b_1}{2}{n}$
and $a_2' = \bits{a_2}{2}{n}$.
Let $\mathcal{T}_0'$ be the optimal spanning set of
$f' = f^{n-1}_{\interval{\rep{0}{n-1}}{b_1'},
\interval{a_2'}{\rep{1}{n-1}}}$.
Note that $f'$ is of the same type
(that is $2$-interval $2$-step)
and has a lower arity,
so we can span it by recursion.
Let $\mathcal{T}_0$ be the $n$-bit set we get
by prepending the symbol $0$
to each vector from $\mathcal{T}_0'$
($\mathcal{T}_0 = \curly{0 T | T \in \mathcal{T}_0'}$).
Let $\mathcal{T}_1 = \curly{1 \rep{\phi}{n-1}}$.
Let $\mathcal{T} = \mathcal{T}_0 \cup \mathcal{T}_1$.
We claim that $\mathcal{T}$ spans exactly
$f^n_{\interval{\rep{0}{n}}{b_1},
\interval{a_2}{\rep{1}{n}}}$
and that $\mathcal{T}$ is minimum such.

\begin{theorem}
$\mathcal{T}$ spans exactly
$f^n_{\interval{\rep{0}{n}}{b_1},
\interval{a_2}{\rep{1}{n}}}$ (feasibility).
\end{theorem}

\begin{proof}
\begin{enumerate}
% TODO: Typeset the following item more to the left, for example by breaking line here.
\item{$span(\mathcal{T}) \subseteq TP(f)$}

Let $c \in span(T)$, $T \in \mathcal{T}$.
We need to show that $c \leq b_1$ or $c \geq a_2$.

\begin{enumerate}
\item $\bit{c}{1} = 1$: Since $\bit{a_2}{1} = 0$,
necessarily $c \geq a_2$.

\item $\bit{c}{1} = 0$: Necessarily $T \in \mathcal{T}_0$.
Let $T' = \bits{T}{2}{n}$ and $c' = \bits{c}{2}{n}$.
Since $T$ spans $c$, $T'$ spans $c'$.
By construction of $\mathcal{T}_0$
necessarily $T' \in \mathcal{T}_0'$,
so $T'$ does not span any number
in $\interval{b_1' + 1}{a_2' - 1}$.
Thus $c' \leq b_1'$ or $c' \geq a_2'$.
Observe that prepending a $0$ bit
to $c'$, $b_1'$ and $a_2'$
preserves the inequalities:
\[
c' \leq b_1' \text{ or } c' \geq a_2'
\Rightarrow
0 c' \leq 0 b_1' \text{ or } 0 c' \geq 0 a_2'
\]

Since $0 c' = c$, $0 a' = a$ and $0 b' = b$,
we get $c \leq b_1$ or $c \geq a_2$.
% meaning f(c) = 1
\end{enumerate}

\item{$TP(f) \subseteq span(\mathcal{T})$}

Let $c \leq b_1$ or $c \geq a_2$.
We need a $T \in \mathcal{T}$ that spans $c$.

\begin{enumerate}
\item $\bit{c}{1} = 1$:
$1 \phi^{n-1} \in \mathcal{T}_1 \subseteq \mathcal{T}$
spans $c$.

\item $\bit{c}{1} = 0$:
Similarly to $b_1'$ and $a_2'$, let $c' = \bits{c}{2}{n}$.
Since $b_1$, $a_2$ and $c$ all start with a $0$ bit,
$c' \leq b_1'$ or $c' \geq a_2'$.
Since $\mathcal{T}_0'$ spans
$f^{n-1}_{\interval{\rep{0}{n-1}}{b_1'},
\interval{a_2'}{\rep{1}{n-1}}}$,
$\ex{T \in \mathcal{T}_0'}{T \text{ spans } c'}$.
Prepending the symbol $0$ to both $T$ and $c'$
preserves spanning,
so $0 T \in \mathcal{T}_0 \subseteq \mathcal{T}$ spans $c$.
\end{enumerate}

\end{enumerate}
\end{proof}

\subsection{\texorpdfstring{$\bit{b_1}{1}
\neq \bit{a_2}{1}$}
{b1[1] != a2[1]}
}

\section{\texorpdfstring{$3$}{3}-step functions}

% TODO: Finish.
